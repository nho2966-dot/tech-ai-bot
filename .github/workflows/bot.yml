name: build_and_run_sovereign
on:
  schedule:
    - cron: '0 */2 * * *' # ÙŠØ¹Ù…Ù„ Ù…Ø±Ø© ÙƒÙ„ Ø³Ø§Ø¹ØªÙŠÙ† (ØªÙˆÙ‚ÙŠØª Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ)
  workflow_dispatch: # ÙŠØ³Ù…Ø­ Ù„Ùƒ Ø¨ØªØ´ØºÙŠÙ„Ù‡ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©

permissions:
  contents: write # Ø¶Ø±ÙˆØ±ÙŠ Ø¬Ø¯Ø§Ù‹ Ù„Ø­ÙØ¸ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install tweepy feedparser openai python-dotenv
          
      - name: Run Sovereign Bot V76
        env:
          X_BEARER_TOKEN: ${{ secrets.X_BEARER_TOKEN }}
          X_API_KEY: ${{ secrets.X_API_KEY }}
          X_API_SECRET: ${{ secrets.X_API_SECRET }}
          X_ACCESS_TOKEN: ${{ secrets.X_ACCESS_TOKEN }}
          X_ACCESS_SECRET: ${{ secrets.X_ACCESS_SECRET }}
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        run: python main.py

      - name: Commit and Sync Memory
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "Sovereign-Bot-Action"
          git add *.db
          git commit -m "ğŸ›¡ï¸ Update Strategic Memory [Skip CI]" || echo "No changes to commit"
          git push
