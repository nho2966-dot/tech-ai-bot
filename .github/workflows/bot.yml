name: Tech AI Bot - Professional CI/CD with Retry

on:
  workflow_dispatch:
  schedule:
    - cron: '0 * * * *' # ÙƒÙ„ Ø³Ø§Ø¹Ø©

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 15  # ØªÙ…Ø¯ÙŠØ¯ Ø¨Ø³ÙŠØ· Ù„Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¹Ù†Ø¯ 429

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          cache: 'pip'

      - name: ğŸ“¦ Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install tweepy feedparser openai python-dotenv

      - name: ğŸ¤– Run Tech Bot with Retry
        env:
          X_BEARER_TOKEN: ${{ secrets.X_BEARER_TOKEN }}
          X_API_KEY: ${{ secrets.X_API_KEY }}
          X_API_SECRET: ${{ secrets.X_API_SECRET }}
          X_ACCESS_TOKEN: ${{ secrets.X_ACCESS_TOKEN }}
          X_ACCESS_SECRET: ${{ secrets.X_ACCESS_SECRET }}
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        run: |
          # Retry loop Ù„Ù„Ù€ AI Ùˆ X API
          for attempt in 1 2 3; do
            echo "ğŸ”„ Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ´ØºÙŠÙ„ Tech Bot Ø±Ù‚Ù… $attempt"
            python main.py && break || echo "âš ï¸ Ø®Ø·Ø£ Ù…Ø¤Ù‚ØªØŒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ 1 Ø¯Ù‚ÙŠÙ‚Ø©..." && sleep 60
          done

      - name: ğŸ’¾ Save Bot Memory
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action Bot"
          git add tech_om_enterprise_2026.db
          git commit -m "ğŸ›¡ï¸ Update Bot Memory [skip ci]" || echo "No changes to commit"
          git push
