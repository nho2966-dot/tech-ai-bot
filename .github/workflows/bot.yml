name: Sovereign Apex Bot CI/CD

on:
  schedule:
    # Ø³ÙŠØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª ÙƒÙ„ Ø³Ø§Ø¹Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù„Ø­Ø¸ÙŠØ© Ù„Ù„Ø£Ø®Ø¨Ø§Ø±
    - cron: '0 * * * *'
  workflow_dispatch: # ÙŠØªÙŠØ­ Ù„Ùƒ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Cache Dependencies
        uses: actions/cache@v3
        with:
          path: ~/.cache/pip
          key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements.txt') }}
          restore-keys: |
            ${{ runner.os }}-pip-

      - name: Install All Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install tweepy feedparser requests beautifulsoup4 openai python-dotenv numpy

      - name: Execute Sovereign Bot
        env:
          # ØªØ£ÙƒØ¯ Ø£Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù…Ø·Ø§Ø¨Ù‚Ø© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ù…Ø§ ÙˆØ¶Ø¹ØªÙ‡ ÙÙŠ Secrets Ø¨Ù…Ø³ØªÙˆØ¯Ø¹Ùƒ
          OPENROUTER_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
          X_API_KEY: ${{ secrets.X_API_KEY }}
          X_API_SECRET: ${{ secrets.X_API_SECRET }}
          X_ACCESS_TOKEN: ${{ secrets.X_ACCESS_TOKEN }}
          X_ACCESS_SECRET: ${{ secrets.X_ACCESS_SECRET }}
          X_BEARER_TOKEN: ${{ secrets.X_BEARER_TOKEN }}
        run: python main.py

      - name: Keep Database Persistent
        # Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØ¶Ù…Ù† Ø­ÙØ¸ Ø§Ù„Ø°Ø§ÙƒØ±Ø© (Memory) ÙˆØ§Ù„ØªØ´Ø§Ø¨Ù‡ Ø§Ù„Ø¯Ù„Ø§Ù„ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ù„Ø³Ø§Øª
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ›¡ï¸ Update Sovereign Memory [Automated]"
          file_pattern: "*.db"
